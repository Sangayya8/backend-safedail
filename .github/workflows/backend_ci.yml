name: SafeDial Backend CI/CD

on:
  push:
    branches: [main, development]
  pull_request:
    branches: [main, development]

jobs:
  build-test:
    runs-on: ubuntu-latest

    steps:
    - name: â¬‡ï¸ Checkout code
      uses: actions/checkout@v3

    - name: ðŸ§° Set up Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '22.15.0'

    - name: ðŸ“¦ Install dependencies
      run: npm install

    - name: ðŸ§ª Run tests (if available)
      run: |
        if [ -f package.json ] && jq -e '.scripts.test' package.json > /dev/null; then
          npm test
        else
          echo "No test script found"
        fi

    - name: ðŸ“œ Print app version
      run: |
        echo "App Name: $(jq -r '.name' package.json)"
        echo "Version: $(jq -r '.version' package.json)"
